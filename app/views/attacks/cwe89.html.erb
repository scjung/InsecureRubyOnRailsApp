<% provide(:title, 'CWE-89: SQL Injection') %>
<h1>CWE-89: SQL Injection</h1>

<div class="row">
  <div class="col-md-6 col-md-offset-3">
    <%= form_with(url: attack_path(89), method: :patch, local: true) do |f| %>
      <div class="form-group">
        <%= f.label :query do %>
          Input a user name:
        <% end %>
        <%= f.text_field :query, class: 'form-control', placeholder: 'user id' %>
        <span class="help-block">
          <p>Sample input: <%= @user %></p>
        </span>
        <span class="help-block">
          <p>Malicious input: ' or ? or 1) --</p>
        </span>
      </div>

      <div class="checkbox">
        <%= f.label :defense do %>
          <%= f.check_box :defense %>
          Defense the attack
        <% end %>
      </div>

      <%= f.submit 'Submit', class: 'btn btn-primary' %>
    <% end %>
  </div>
</div>

<% if @article %>
  <div class="row">
    <div class="col-md-6 col-md-offset-3">
      <ol class="articles">
        <%= render @article %>
      </ol>
    </div>
  </div>
<% end %>